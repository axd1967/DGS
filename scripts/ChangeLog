------------------------------------------------------------------
General infos
------------------------------------------------------------------
changelog reference at:
http://www.gnu.org/prep/standards/html_node/Change-Logs.html

previous server update:
Release [2012-06-08] - DGS 1.0.15 - CVS-tag [DGS-stable-20120608] on branch [DGS-stable-201206]

Developers INFO:

2012-06-07 juga
   Tournaments, Quick-Suite, Game-Editor

2007-12-23 rodival
   Code Cleanup, New Features

------------------------------------------------------------------
ChangeLog
------------------------------------------------------------------

2012-09-01 juga

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     specs/db/dragon-ddl.sql:
   - replace varchars to get fixed-size tables: ConfigPages, Folders, Forums, IpStats,
     TranslationGroups, TranslationLanguages, TranslationPages, TournamentExtension,
     TournamentLadderProps, TournamentProperties, TournamentRound
-----------
-- replace varchars to get fixed-size tables
ALTER TABLE ConfigPages
   MODIFY StatusFolders char(40) NOT NULL default '' ;
ALTER TABLE Folders
   MODIFY Name char(40) NOT NULL,
   MODIFY BGColor char(8) NOT NULL default 'f7f5e3FF',
   MODIFY FGColor char(6) NOT NULL default '000000' ;
ALTER TABLE Forums
   MODIFY Name char(40) NOT NULL default '',
   MODIFY Description char(128) NOT NULL default '',
   MODIFY SortOrder tinyint unsigned NOT NULL default '0' ;
ALTER TABLE IpStats
   MODIFY IP char(16) NOT NULL ;
ALTER TABLE TranslationGroups
   MODIFY Groupname char(32) NOT NULL ;
ALTER TABLE TranslationLanguages
   MODIFY Language char(32) NOT NULL,
   MODIFY Name char(32) NOT NULL ;
ALTER TABLE TranslationPages
   MODIFY Page char(64) NOT NULL ;
ALTER TABLE TournamentExtension
   MODIFY ChangedBy char(54) NOT NULL default '' ;
ALTER TABLE TournamentLadderProps
   MODIFY ChangedBy char(54) NOT NULL default '' ;
ALTER TABLE TournamentProperties
   MODIFY ChangedBy char(54) NOT NULL default '' ;
ALTER TABLE TournamentRound
   MODIFY ChangedBy char(54) NOT NULL default '' ;
-----------

   * labels.rdf:
   - fix PHP-warnings noticed by E_STRICT:
     added empty "labels.rdf", see http://www.java-samples.com/showtutorial.php?tutorialid=1584

   * include/connect2mysql.php (mysql_single_fetch),
     include/coords.php (get_hoshi_coords),
     include/make_translationfiles.php (fnop),
     daily_cron.php:
   - fix PHP-warnings noticed by E_STRICT:
     missing include, missing resource-check, check allowed args, define unknown func 'fnop'

   * include/db_classes.php (Entity),
     include/filter_functions.php (sql_replace_wildcards),
     include/form_functions.php (Form, ~.create_form_string),
     include/game_functions.php (GameSnapshot.parse_stones_snapshot),
     include/std_classes.php (QuerySQL, ~.add_part, ~.addIndex),
     include/table_columns.php (Table.set_default_sort, ~.set_sort),
     include/utilities.php (array_intersect_key_values),
     include/quick/quick_game.php (QuickHandlerGame.convert_coords):
   - cleanup: refactor static calculated loop-expression out of loop
   - use defined consts

   * include/timezones.php (get_timezone_array),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
   - use alias 'Asia/Shanghai' for removed tzdata of 'China/Shanghai'-timezone as live-system
     does not know it anymore
-----------
-- use alias for removed tzdata of 'China/Shanghai'-timezone
UPDATE Players
   SET Timezone='Asia/Shanghai' WHERE Timezone ='China/Shanghai' ;
-----------

   * include/contacts.php (Contact.load_quick_contacts, ~.getContactUserFlags, ~.getContactSystemFlags),
     include/game_functions.php (NextGameOrder.get_next_game_order),
     include/quick/quick_game_list.php (QuickHandlerGameList.prepare),
     include/quick/quick_handler.php (class QuickHandler, ~.add_list),
     include/quick/quick_game_info.php (QuickHandlerGameInfo.fill_game_info),
     include/quick/quick_contact.php (QuickHandlerContact.build_obj_contact_user),
     specs/quick_suite.txt:
   - quick-handler:
     - game-list: set list_order for all views
     - game-info/list: added 'my_id'-field
     - set 'list_order' for all object-list commands,
       'list_order'-field can contain fieldnames that are not returned in result
     - contact-list:
       - used std-func to build user-info
       - removed contact-user-fields ratingstatus, picture
       - renamed system-flag for quick-suite: WAITINGROOM -> WR_PROTECT_GAMES
       - bugfix: correct contact-user/system-flags for quick-suite

   * include/quick/quick_bulletin.php (QuickHandlerBulletin.prepare):
   - bugfix: fix order-query for bulletin-list quick-handler

   * include/gamelist_control.php (GameListControl.build_games_query),
     include/quick/quick_game_info.php (QuickHandlerGameInfo.fill_game_info),
     include/quick/quick_game_list.php (QuickHandlerGameList.prepare),
     specs/quick_suite.txt:
   - game-list quick-handler: implemented 'finished'-view to show my or other-users finished games

   * include/gamelist_control.php (class GameListControl, ~.build_games_query),
     include/quick/quick_game_info.php (QuickHandlerGameInfo.prepare, ~.fill_game_info),
     include/quick/quick_game_list.php (QuickHandlerGameList.prepare),
     specs/quick_suite.txt, show_games.php:
   - game-list quick-handler: implemented 'running'-view to show my or other-users running games
   - bugfix: load X_Ticks to calculate remaining-time only for my games

   * include/quick/quick_game_info.php (class QuickHandlerGameInfo, ~.prepare, ~.process,
       ~.fill_game_info),
     include/quick/quick_game_list.php (QuickHandlerGameList.prepare, ~.process),
     include/quick/quick_handler.php (QuickHandler.clear_with_options),
     specs/quick_suite.txt, show_games.php:
   - game-list quick-handler:
     - implemented 'observe'-view to show "all observed games" and "games i'm observing"
       - bugfix: show time-remaining only for own games
       - bugfix: cast game-priority to integer
     - implemented 'status'-view
       - allow LIMIT-option 'all' for game-status-view
       - USER_ID restricted to logged-in user
       - added available WITH-option: user_id, prio, notes
       - added available FILTER-options
   - cleanup: use Games-fields instead of extra-fields: -> Black|White_Start_Rating
   - cleanup: unified SQL field-naming: black|whiteRating -> ..Rating2

2012-08-31 juga

   * include/gamelist_control.php (class GameListControl, ~.setView, ~.is_observe, ~.is_running,
       ~.is_finished, ~.is_all, ~.is_observe_all, ~.is_status, ~.is_info, ~.build_games_query,
       ~.build_game_list_query_status_view, ~.extend_game_list_query_with_user_info),
     include/game_functions.php (GameHelper.extend_query_with_game_notes,
       ~.extend_query_with_game_prio;
       NextGameOrder.build_status_games_query),
     include/quick/quick_game_list.php (class QuickHandlerGameList, ~.canHandle, ~.parseURL,
       ~.prepare, ~.process),
     include/quick/quick_game_info.php (class QuickHandlerGameInfo, ~.prepare, ~.process,
       ~.fill_game_info),
     specs/quick_suite.txt, quick_status.php, show_games.php, status.php:
   - game-info quick-handler:
     - completed implementation of "info"-command for game-quick-handler
     - added WITH-option to control adding fields: user_id, prio, notes, ratingdiff
     - added fields for game-info: jigo_mode, notes, prio, game_action
     - refactored building for game-info and game-list queries into GameListControl-class
     - refactored building game-info-result to be used for all views
   - game-list quick-handler:
     - refactored to merge with game-info, started to clean up list-views
     - added FILTER-options for MPG, tournaments
     - added LIMIT-handling
   - bugfix show_games: URL-argument finished must be set (<>0) to activate finished-view
   - cleanup:
     - refactored all classes from 'include/classlib_game.php' into 'include/game_functions.php'
     - refactored specific status-query-parts into NextGameOrder::build_status_games_query()
     - merged QuickHandler.build_obj_user2() into QuickHandler.build_obj_user()

   * include/game_functions.php (class GameScore; class BoardStatus; class NextGameOrder;
       class GameSnapshot),
     include/classlib_game.php [REMOVED],
     include/board.php, include/make_game.php, include/message_functions.php,
     include/move.php, include/sgf_builder.php, include/shape_control.php,
     tournaments/include/tournament_rules.php, scripts/check_players_email.php,
     scripts/fix_games_timeleft.php, scripts/game_consistency.php,
     clock_tick.php, confirm.php, game.php, gameinfo.php, new_game.php, wap/status.php:
   - cleanup: refactored all classes from 'include/classlib_game.php' into 'include/game_functions.php'

   * include/quick/quick_handler.php (class QuickHandler, ~.build_obj_user),
     include/quick/quick_bulletin.php, include/quick/quick_contact.php,
     include/quick/quick_message.php, include/quick/quick_wroom.php:
   - cleanup: merged QuickHandler.build_obj_user2() into QuickHandler.build_obj_user()

   * include/db/games.php (class Games, ~.new_from_row):
   - store original game-row in container

2012-08-30 juga

   * include/quick/quick_wroom.php (class QuickHandlerWaitingroom, ~.parseURL, ~.process,
       ~.process_cmd_list, ~.fill_wroom_object),
     include/quick/quick_handler.php (class QuickHandler, ~.parseFilters),
     include/wroom_control.php (WaitingroomControl.get_waitingroom_restrictions,
       ~.check_joining_waitingroom),
     include/game_functions.php (MaxGamesCheck.get_error_text, ~.get_warn_text),
     specs/quick_suite.txt,
     waiting_room.php (add_old_game_form):
   - quick-suite:
     - specified and implemented standard-way to parse and handle filter-values for quick-suite
     - waitingroom quick-handler:
       - added suitable-filter with default ON for 'list'-command
       - refactor additional checks from 'add_old_game_form()' into WaitingroomOffer-class
         also to be used for quick-suite waitingroom-info quick-handler
       - changed and added fields for 'info'-command:
         - 'can_join' renamed to 'join' to have prefix on join-fields,
         - added 'join_warn' & 'join_err'-fields
         - 'opp_started_games'-fields only for 'info'

2012-08-29 juga

   * include/quick/quick_wroom.php (class QuickHandlerWaitingroom, ~.prepare, ~.process,
       ~.process_cmd_list, ~.fill_wroom_object),
     include/db/waitingroom.php (Waitingroom.load_waitingroom_entries),
     specs/quick_suite.txt:
   - waitingroom-list quick-handler:
     - implemented 'list'-command returning all waiting-room-entries
     - fields calc_handicap & calc_komi now empty instead of omitted;
       this is needed to have complete list of fields for all list-entries

   * include/quick/quick_handler.php (class QuickHandler, ~._parse_options, ~.is_with_option,
       ~.check_list_style, ~.add_query_limits, ~.read_found_rows, ~.add_list),
     include/quick/quick_bulletin.php (QuickHandlerBulletin.prepare, ~.process_cmd_list),
     include/quick/quick_contact.php (QuickHandlerContact.prepare),
     include/quick/quick_folder.php (QuickHandlerFolder.prepare, ~.process_cmd_list),
     include/globals.php (QUICK_VERSION), specs/quick_suite.txt:
   - added standard-option to specify LIMIT and OFFSET with defaults
   - added 'list_totals' as standard-field in list-response with total count of rows
   - set std-field 'list_has_next' in list-repsonse to 1 if there are is a next-page
     to retrieve for list-command
   - added missing order-by-fields for existing lists: bulletin, folder
   - minor changes (renamed vars, cleaned up time-format-specs)

   * include/quick/quick_contact.php (QuickHandlerContact.build_obj_contact_user),
     specs/quick_suite.txt:
   - contact-list quick-handler: add additional user-data only if WITH-option='user_id'

   * include/quick/quick_handler.php (class QuickHandler, ~.getProcessedResult, ~.add_list,
       ~.clear_unexpected_fields, ~.buildObjectArray),
     specs/quick_suite.txt, quick_do.php:
   - added standard-option 'fields' to restrict the output of fields in the quick-response
     - always include standard-fields: version,error*,quota_*,list_*,id
     - include all fields if fields-option omitted or empty
     - match on 1st-level of field-keys in response
     - check syntax of fields-option: plain fieldname or *-suffix-pattern

2012-08-28 juga

   * include/quick/quick_wroom.php (class QuickHandlerWaitingroom, ~.prepare, ~.process_cmd_info),
     include/wroom_control.php (WaitingroomControl.build_waiting_room_query, ~.get_waitingroom_restrictions;
       class WaitingroomOffer, ~.is_fairkomi, ~.is_my_game, ~.calculate_offer_settings, ~.determine_color),
     include/db/waitingroom.php (class Waitingroom, ~.build_query_sql, ~.new_from_row,
       ~.load_waitingroom_by_query),
     include/message_functions.php (echo_game_restrictions),
     include/rating.php (user_has_rating),
     specs/quick_suite.txt,
     waiting_room.php (add_old_game_form):
   - implemented game-settings calculations for waiting-room quick-handler for "info"-command
     - refactored building of query for waiting-room into WaitingroomControl-class
     - refactored game-settings calculations of color/handicap/komi/settings into WaitingroomOffer-class
   - bugfix: overwrite default-profile also for "info"-link

   * include/std_functions.php (who_is_logged, is_logged_in),
     error.php, quick_do.php, quick_play.php:
   - quick-play: check for quota-exceeded, set timezone
     - replaced login-check, login-denied-check, ip-stats by using standard login who_is_logged()

   * quick_status.php:
   - check for login-denied

   * include/error_functions.php (class DgsErrors, ~.set_mode, ~.add_error):
   - bugfix: added configuration of DgsErrors for setting HTTP-Header
     - use 'application/json' HTTP-HEADER also for errors for ERROR_MODE_QUICK_SUITE

2012-08-26 juga

### ----- release-1_0_15-20120608 -----

   * game.php, message.php, new_game.php, site_map.php, waiting_room.php,
     forum/forum_functions.php, forum/index.php, include/table_columns.php,
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     tournaments/edit_participant.php, tournaments/edit_status.php,
     tournaments/game_admin.php, tournaments/register.php,
     tournaments/view_tournament.php:
   - fix translation-texts for live-servers preventing double text-entries
     - Send Message -> Send message
     - New game -> New Game
     - for forum: new -> new#forum, reply -> reply#forum, hide -> hide#forum, show -> show#forum
     - prev page -> Prev Page, next page -> Next Page
     - Tournament Status -> Tournament Status#tourney
-----------
-- fix translation-adjustments in code
-- 1. following selects must results in not more than one entry per select
SELECT * FROM TranslationTexts WHERE Text='Send Message';
SELECT * from TranslationTexts where Text='prev page';
SELECT * from TranslationTexts where Text='next page';
SELECT * from TranslationTexts where Text='Tournament Status';

-- 2. only if criteria in (1) is met, update the following:
UPDATE TranslationTexts SET Text='Send message' where Text='Send Message' LIMIT 1;
UPDATE TranslationTexts SET Text='Prev Page' WHERE Text='prev page' LIMIT 1;
UPDATE TranslationTexts SET Text='Next Page' WHERE Text='next page' LIMIT 1;
UPDATE TranslationTexts SET Text='Tournament Status#tourney' WHERE Text='Tournament Status' LIMIT 1;
-----------

   * include/translation_functions.php (strip_translation_label),
     include/make_translationfiles.php (TRANS_ROW_PER_PAGE),
     translate.php (update_translation),
     update_translation.php [REMOVED]:
   - added preview for translations
     - refactored saving translations from 'update_translation.php'
       into 'translate.php' for preview-support
     - strip translation-label
   - reduced row-number for translating: 30 -> 10

2012-08-25 juga

   * scripts/obsolete/alter_moves_table.php, scripts/obsolete/calculate_no_games.php,
     scripts/obsolete/convert_move_tables.php, scripts/obsolete/delete_move_tables.php,
     scripts/obsolete/fix_frombackuptable.php, scripts/obsolete/fix_frombackuptable2.php,
     scripts/obsolete/fix_rated_status.php, scripts/obsolete/game_test.php,
     scripts/obsolete/index_old.php, scripts/obsolete/make_gmdate.php,
     scripts/obsolete/mlrate.php:
     - removed old scripts, that are no longer useful due to changed tables

   * translate.php, skins/dragon/screen.css:
   - show preview of translated text under translation-text currently stored
   - added admin-info about new TranslationTexts-fields: Type, Status
   - added last-change date of original and translated text

   * include/admin_faq_functions.php (AdminFAQ.save_new_faq_entry, ~.update_faq_entry),
     include/make_translationfiles.php (translations_query, add_text_to_translate,
       generate_translation_texts),
     include/translation_functions.php (get_translation_group),
     scripts/translation_consistency.php (commit_query, check_consistency_faq,
       check_consistency_tfig, check_consistency_transl, check_consistency_texts),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql, specs/db/dragon-ddl.sql,
     scripts/data_export.php, scripts/README.developers, scripts/README.translations,
     admin_show_faqlog.php:
   - re-worked translation-handling for better consistency-checks and automatic fixes
     - re-worked translation-consistency-script adding more checks and automatic fixes
       - added checks for all translation-tables and all the fields
       - FAQ/Links/Intro: check Parent-FK, SortOrder, Level, Question/Answer-FK, Reference
       - TranslationFoundInGroup: check FK
       - Translations: check Language_ID-FK, Original_ID-FK, check/fix Updated
       - TranslationTexts: check missing/unused TFIG, identify orphan texts, Type,
         case-insensitive double-texts, check/fix Updated
       - added indexes for faster consistency-checks
     - added TranslationTexts/FAQlog.Type to mark the source of the text,
       - prevent double-texts of same type: FAQ, Links, Intro, source-code, unknown (NONE)
       - keep separate realms for FAQ/Links/Intro-texts and source-code
     - bugfix: fix FAQ-admin on edit-link dependent on Type to edit FAQ/Links/Intro
     - added TranslationTexts/Translations.Updated as last-change-date
     - dropped unused translation-columns: TranslationTexts.Ref_ID, FAQlog.CString
     - updated documentation about translation-handling
-----------
-- add Type to check for double-text of same type
ALTER TABLE TranslationTexts
   ADD Type enum('NONE','FAQ','LINKS','INTRO','SRC') NOT NULL default 'NONE' AFTER Text ;
ALTER TABLE FAQlog
   ADD Type enum('FAQ','Links','Intro') NOT NULL default 'FAQ' AFTER FAQID ;
ALTER TABLE FAQlog
   CHANGE FAQID Ref_ID int(11) NOT NULL default '0' ;

-- add index for faster consistency-checks, add Type to check for double-text of same type
ALTER TABLE TranslationTexts
   ADD KEY Text (Text(4)) ;
ALTER TABLE Translations
   ADD KEY Original_ID (Original_ID) ;
ANALYZE TABLE TranslationTexts;
ANALYZE TABLE Translations;

-- drop unused columns
ALTER TABLE Translationlog
   DROP COLUMN CString ;
ALTER TABLE TranslationTexts
   DROP COLUMN Ref_ID ;
-----------

   * admin_faq.php, links.php (save_link_section, save_link_entry):
   - changed translation-group for links-page (Docs -> Links) and intro-page (Start -> Intro)

2012-08-20 juga

   * include/admin_faq_functions.php (AdminFAQ.get_faq_entry_row, ~.save_new_faq_entry,
       ~.update_faq_entry),
     include/make_translationfiles.php (add_text_to_translate, generate_translation_texts,
       find_translation_texts, eat_comments, eat_whitespace, eat_translation_text),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     scripts/generate_translation_texts.php,
     scripts/data_export.php, specs/db/dragon-ddl.sql,
     admin_faq.php, update_translation.php:
   - handle case-INsensitive checking of existing translation-texts
     - re-use case-different text if marked as ORPHAN
     - forcing to manually resolve to unique translation-texts by reporting as error
   - Admin-FAQ: show added last-change-date TranslationTexts.Updated for FAQ/Intro/Links
     question- & answer-text, disable checkbox if no translation-check needed
   - update TranslationTexts.Updated on translating
   - added TranslationTexts.Status to support translation-consistency-checking for orphan texts
   - fix bug: write TranslationTexts.Ref_ID only for FAQ-texts, not for Intro/Links-references
   - moved generate_translation_texts() and related funcs
     from 'scripts/generate_translation_texts.php' into 'include/make_translationfiles.php'
-----------
-- added last-change and status for translations for easier cleanup
ALTER TABLE TranslationTexts
   ADD Status enum('USED','CHECK','ORPHAN') NOT NULL default 'USED',
   ADD Updated datetime NOT NULL default '0000-00-00 00:00:00' ;
ALTER TABLE Translations
   ADD Updated datetime NOT NULL default '0000-00-00 00:00:00' ;
-----------

   * introduction.php, links.php:
   - used own translation-group

   * include/connect2mysql.php (writeIpStats):
   - disable writing ip-stats for now

   * scripts/obsolete/fix_faq.php:
   - removed obsolete

2012-08-14 juga

   * include/message_functions.php (fix_invitations_replied), daily_cron.php:
   - fix bug: on invitation-cleanup the referenced game for an invitation is deleted
     leaving the message with Replied='M' indicating a reply is needed, which is not
     possible without the game. Therefore fix those messages by setting Replied='N'
     to allow changing folders and no further reply being needed.

2012-08-13 juga

   * include/std_functions.php (make_dragon_main_menu), site_map.php:
   - corrected links to feature-list and tournament-list

   * list_shapes.php, waiting_room.php:
   - fix bug: missed named-filters 'user/pub' for profile-saving for shape-list
   - fix bug: allow overwriting filter-values otherwise loaded from existing default-profile

   * features/edit_feature.php, features/list_votes.php, features/vote_feature.php:
   - fix bug: allow overwriting filter-values otherwise loaded from existing default-profile
   - removed 'Feature Vote Results'-link being available in main-menu with 'Features'
   - added 'All features'-link

   * features/list_features.php, skins/dragon/screen.css:
   - fix bug: allow overwriting filter-values otherwise loaded from existing default-profile
   - fix bug: missed named-filters 'status' for profile-saving for feature-list
   - change title according to filter-selection on my-vote & status
   - show missing feature-vote with blue-background and '?'
   - added 'All features'-link

   * tournaments/list_tournaments.php:
   - fix bug: removed named-filters 'uid/tdir' for profile-saving,
     removed search-profile for hidden static filters 'uid/tdir'
   - adjusted link-text: Show all tournaments -> All tournaments

   * list_surveys.php:
   - fix bug: missed named-filters 'handle' for profile-saving for survey-list

   * list_bulletins.php:
   - forbid using default-search-profile to preserve showing of important bulletins

   * include/classlib_profile.php (class SearchProfile, ~.set_forbid_default, ~.get_arg,
       ~.handle_action, ~.get_form_elements),
     include/globals.php (SP_OVERWRITE_ARGS, SPURI_ARGS):
   - fix bug: allow overwriting filter-values otherwise loaded from existing default-profile
   - forbid using default-search-profile

   * include/filter.php (SearchFilter.get_saved_arg; Filter.to_string):
   - minor changes: added debugging, fix bug in Filter.to_string() printing dbfield if object

2012-08-12 juga

   * include/sgf_parser.php (class SgfParser, ~.parse_sgf),
     goban_editor.php (load_igoban_from_sgf, create_igoban_from_parsed_sgf):
   - fix bug in goban-editor: captures were not removed on loading and parsing SGF
     - parse SGF into object SgfParser, parse also handicap and komi
     - placed errors below section-header

   * site_map.php:
   - fix bug: show link for my-shape-list only for valid user-handle

2012-08-10 juga

   * include/quick/quick_message.php (QuickHandlerMessage.prepare, ~.process_cmd_info),
     include/message_functions.php (DgsMessage.update_message_folder),
     specs/quick_suite.txt:
   - quick-message-handler: move message into target-folder on "info"-command if specified

   * message.php:
   - removed initial warning of missing subject/receiver, show only on preview and submit

   * edit_shape.php, view_shape.php:
   - word-wrap shape-notes on view/edit-shape to 60 chars

   * list_shapes.php:
   - show shape-notes on tool-tip for shape-lists

   * include/time_functions.php (build_time_remaining; TimeFormat.echo_time_remaining),
     include/quick/quick_game_info.php (QuickHandlerGameInfo.process_cmd_info),
     include/quick/quick_game_list.php (QuickHandlerGameList.build_game_info),
     scripts/tests/TimeFormatTest.php, specs/time.txt,
     tournaments/game_admin.php (draw_add_time),
     tournaments/list_tournaments.php,
     game.php, gameinfo.php, quick_status.php, status.php,
     code_examples/check_times.php:
   - cleanup time-formats for remaining-time:
     - always show extra-time information by removing TIMEFMT_ADDEXTRA,
       except new TIMEFMT_NO_EXTRA-flag used for old quick-status
     - removed abbreviated time-formats by removing TIMEFMT_ABBEXTRA
     - for japanese-byo-yomi replaced "(-)" to indicate last byo-yomi-period
       with "X * 0" to avoid ambiguity with "(-)" also representing "absolute time"

2012-08-08 juga

   * include/game_functions.php (increaseMoveStats):
   - disabled writing move-statistics

   * waiting_room.php:
   - added game-type-filter to show games without shape
   - added handicap-type-filter to show games without fair-komi

   * include/make_game.php (create_game):
   - fix bug: Column 'Snapshot' specified twice

   * clock_tick.php, daily_cron.php, halfhourly_cron.php,
     tournaments/cron_tournaments.php, specs/db/dragon-ddl.sql,
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
   - store end-time of cron-run
-----------
-- store end-time of cron-run
ALTER TABLE Clock
   ADD Finished datetime NOT NULL default '0000-00-00 00:00:00' ;
-----------

2012-07-17 juga

   * include/quick/quick_message.php (QuickHandlerMessage.process_cmd_info):
   - bugfix: 'created_at'-field took data from wrong var

2012-07-16 juga

   * status.php:
   - show time-remaining of games in short but non-abbreviated form

2012-07-15 juga

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql, specs/db/dragon-ddl.sql:
   - speed-up cleanup of MoveStats by adding key required to remove old entries
-----------
-- speed-up cleanup of MoveStats
ALTER TABLE MoveStats
   ADD KEY SlotWeek (SlotWeek) ;
-----------

   * include/quick/quick_message.php (QuickHandlerMessage.prepare):
   - bugfix: option 'mid' is optional for send-message (or 0 for new msg),
     or if present it must be numeric and >0 for reply-msg

2012-07-14 juga

   * halfhourly_cron.php:
   - fix bug: resetting game-clock for player leaving vacation used wrong clock
     for LastTicks-calculation for games with weekend-clock stopped

   * include/quick/quick_message.php (class QuickHandlerMessage, ~.process_cmd_send_msg):
   - fix bug: add options 'subj|msg' to allowed options

2012-07-12 juga

   * halfhourly_cron.php:
   - added time-measure for processing one user for mail-notifications
   - disabled db-query debugging

   * edit_profile.php:
   - bugfix: adjusted check to email being optional if email-notification is disabled
   - bugfix: allow disabling email-notification regardless of given email

2012-07-11 juga

   * include/config.php (SENDMAIL_PARAMETERS),
     include/std_functions.php (send_email):
   - added local sendmail-parameters SENDMAIL_PARAMETERS for local MTA
     used for sending mail in send_email()-function

   * halfhourly_cron.php:
   - change order for mail-notifications: handle oldest-access users first
     as newer-access-users can see new games/messages anyway

   * include/std_functions.php (delete_all_observers), admin_game.php:
   - notify users for new-message in mail-notifications on game-deletion and game-end for observers

   * include/std_functions.php (send_email):
   - log time to send mail

   * include/std_functions.php (USERFLAG_NFY_BUT_NO_OR_INVALID_EMAIL, notify),
     admin_users.php,
     edit_profile.php,
     halfhourly_cron.php:
   - introduced user-flag USERFLAG_NFY_BUT_NO_OR_INVALID_EMAIL to mark user-account
     with missing or having an invalid email-address
     - halfhourly-cron: send user a message to correct the email in user-profile
       on missing or invalid email for mail-notifications in halfhourly-cron,
     - edit-profile: reset flag when editing user-profile after providing a valid email
     - edit-profile: show error if mail-notifications enabled by email is missing

   * include/std_functions.php (send_message, notify),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     specs/db/table-Players.txt, specs/db/dragon-ddl.sql,
     halfhourly_cron.php:
   - mail-notifications: for Players.Notify=NEXT always both, games-to-move and
     new-messages are checked. Checking for new messages almost always is a slow
     query (7-12 on average).
     Therefore introducing notify-flags that indicate if new-messages must be checked or not
     on collecting data for mail-notifications.
     - added Players.NotifyFlags for bitmask indicating new data for mail-notifications
     - used mask 0x01 to indicate to check for new-messages
-----------
-- mark notify-types for mail-notifications
ALTER TABLE Players
   ADD NotifyFlags tinyint unsigned NOT NULL default '0' AFTER Notify ;
UPDATE Players
   SET NotifyFlags=1 WHERE Notify IN ('NOW','NEXT') ;
-----------

2012-07-10 juga

   * include/error_functions.php (need_db_errorlog):
   - disable logging of error-codes: not_logged_in, unknown_user

   * halfhourly_cron.php:
   - order messages by Messages.ID in hope to speed up message-query

   * include/std_functions.php (verify_invalid_email):
   - adjusted email-regex allowing '+' character

   * scripts/check_players_email.php, scripts/index.php:
   - added script to verify email of all players

   * INSTALL:
   - adjusted crontab for halfhourly-cron extending read-timeout (900s wget-default to 1800s)

   * halfhourly_cron.php:
   - fix bug: undo check for found-entries, Notify='NEXT' is indicator that there is something
     new (move or message), SendEmail='ON' needs notify even if NOT checked for new games/messages
   - increased max-run-time from 25min -> 28min

2012-07-09 juga

   * include/std_functions.php (start_page):
   - disabled logging of HTTP-headers (Accept-Language & Accept-Charset) to prep for UTF-8 migration

   * .cvsignore:
   - ignore timeadjust.php, apple-touch-icon*.png

   * halfhourly_cron.php:
   - fix bug: select fast-queries first, then order randomly on SendEmail-"categories"
     if one-run is not enough
   - fix bug: skip mail-notification if nothing to send, but set Players.Notify to 'DONE'
     to avoid re-doing on next run
   - fix bug: removed after-loop setting of Players.Notify='DONE' if loop hadn't handled
     ALL open notifications in one run, so they can be continued on next run

   * daily_cron.php:
   - disable debugging

   * scripts/start_frozen_clocks.php, scripts/tournament_consistency.php,
     scripts/translation_consistency.php, scripts/updates/fix_message_thread-1_0_15.php:
   - set larger max_execution_time instead of relying on 30s timeout-default

   * halfhourly_cron.php, clock_tick.php (handle_game_timeouts):
   - set max_execution_time=0 (no timeout instead of 30s timeout-default)
     - to avoid timeout on large datasets
     - to avoid breaking transactions with multi-table-changes
   - added soft-check on running-time to avoid script running for too long
   - re-ordered task executing send-mail-notifications as last task because
     that takes longest and has greatest "risk" of taking more time
     than the script should run with

   * scripts/message_consistency.php, scripts/recalculate_ratings2.php:
   - added ta_begin/end() to surround multi-table-updates with "transaction"

   * scripts/updates/fix_game_comments-1_0_15.php, scripts/fix_game_snapshot.php,
     scripts/fix_games_timeleft.php, scripts/forum_consistency.php,
     scripts/game_consistency.php, scripts/message_consistency.php,
     scripts/player_consistency.php, scripts/recalculate_ratings2.php,
     scripts/voting_consistency.php, tournaments/cron_tournaments.php:
   - set max_execution_time=0 (no timeout instead of 30s timeout-default)
     - to avoid timeout on large datasets
     - to avoid breaking transactions with multi-table-changes

   * scripts/updates/other_changes_1_0_14_to_1_0_15.txt, INSTALL:
   - added PNG-icons for Apple "favicons" in various size to avoid
     'page_not_found'-errors (ca. 14000/month currently)
-----------
# added image for Apple "favicons", must be copied to root-dir
copy /images/apple-touch-icon-57x57-precomposed.png
copy /images/apple-touch-icon-57x57.png
copy /images/apple-touch-icon-72x72-precomposed.png
copy /images/apple-touch-icon-72x72.png
copy /images/apple-touch-icon-114x114-precomposed.png
copy /images/apple-touch-icon-114x114.png
copy /images/apple-touch-icon-144x144-precomposed.png
copy /images/apple-touch-icon-144x144.png
copy /images/apple-touch-icon-precomposed.png
copy /images/apple-touch-icon.png
-----------

   * include/std_functions.php (is_logged_in):
   - changed fever-vault block-message

2012-07-08 juga

   * include/std_functions.php (LOGIN_SKIP_UPDATE, who_is_logged, is_logged_in),
     error.php:
   - error-page skips update of Players-table on login-check to avoid decreasing quota twice:
     once by main-page + follow-up with error on error-page:
     - do NOT decrease web-access-quota
     - do NOT write IpStats-table
     - do NOT reset mail-notify to 'NONE'
     - do NOT update Players-table or $player_row, e.g. with ip, browser, last-access,
       activity, hits, clock-change
     - do NOT update main-menu indicators for new-messages, new-features, new-bulletins
     - but DO load Players-data with browser-specific prefs, set timezone, load translation-tables,
       check for maintenance-user, handle admin-status

   * include/std_functions.php (is_logged_in):
   - cleanup: refactored query-building for Players-update with UpdateQuery-class

   * admin_users.php (update_user):
   - fix bug: remove editing of Players.OnVacation/UseVacation as special handling
     for the Players.TimeOutDate would be required, also user can change then length
     of OnVacation already so no admin-intervention is needed
   - re-ordered and added some shown-fields: LastQuickAccess, UserFlags, Hits

   * include/std_functions.php (end_page, is_logged_in),
     include/quick_common.php (quick_suite_add_quota):
   - added separate field for Players.VaultTime as $player_row['X_VaultTime']
     preserving original VaultTime-value

   * include/gui_functions.php (is_valid_button, button_style),
     include/std_functions.php (BUTTON_MAX),
     edit_profile.php (parse_edit_form, handle_save_profile),
     change_profile.php [removed]:
   - merged 'edit_profile.php' and 'change_profile.php' into one page:
     - added checks on all input-fields showing errors to user instead of throwing error,
       also in preparation for mandatory email
     - correct some invalid values to defaults if "injected" via URL and not via regular
       form-submit only allowing form-supported field-values restricted by select-boxes
     - save is only done if there are no check-errors any more
     - fix bug: show correct last-capture-marker if ENA_MOVENUMBERS disabled

   * scripts/mailtest.php:
   - fix bug: trim email when checking for valid email

2012-07-07 juga

   * crossdomain.xml:
   - added policy-file for Flash with least-permissive policy
     to prevent 'page_not_found'-errors (ca. 21000/month),
     see also http://www.dragongoserver.net/forum/read.php?forum=2&thread=33297#33464

   * include/std_functions.php (verify_invalid_email, send_email, is_logged_in),
     include/register_functions.php (UserRegistration.check_email),
     scripts/mailtest.php, change_profile.php, halfhourly_cron.php,
     send_new_password.php:
   - fix bugs for handling invalid email:
     - changed name and return-value of verify-method for easier checking:
       verify_email -> verify_invalid_email
     - fixed regex for emails allowing longer TLD of domain to prepare for new-TLDs released by ICANN
     - return 'bad_mail_address'-error also if errors only collected and error()-call is not exiting
  - send-new-password: die-on-error before writing adminlog and saving new password into database
     - fix bugs for halfhourly-cron-script:
     - skip mail notification for user with invalid email,
       script was stopped when mail was sent to invalid email
     - mark user as notified after successful mail-sending
       to avoid being notified again on script-restart

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
   - clearing invalid emails for users if email has no '@' or does contain spaces
-----------
-- cleanup invalid emails (no '@' found or containing space)
SELECT Handle, Lastaccess, Email
   FROM Players WHERE Email>'' AND (Email LIKE '% %' OR NOT Email LIKE '%@%') ;
UPDATE Players
   SET Email='' WHERE Email>'' AND (Email LIKE '% %' OR NOT Email LIKE '%@%') ;
-----------

   * statistics.php (show_stats_user_countries):
   - text-change to allow for easier future changes without re-translating

   * daily_cron.php, halfhourly_cron.php:
   - enable debugging

2012-07-06 juga

   * include/quick_common.php ($clocks_stopped):
   - re-enabled stopped clocks

   * include/game_functions.php (class GameAddTime, ~.add_time_opponent;
       GameHelper.update_clock, ~.load_game_row),
     include/time_functions.php (get_clock_ticks, time_left_ticksdate, timeleft_days_to_ticks),
     include/cache_clock.php (ClockCache.load_clock_ticks, ~.get_clock_cache),
     tournaments/include/tournament_cache.php (class TournamentCache, ~.load_clock_ticks),
     include/classlib_game.php (NextGameOrder.make_timeout_date),
     include/make_game.php (create_game),
     scripts/fix_games_timeleft.php (dbg_query, update_games_timeoutdate),
     scripts/obsolete/game_test.php,
     specs/db/table-Games.txt,
     tournaments/game_admin.php (draw_add_time),
     edit_vacation.php:
   - fix bugs: overworked handling of Games.TimeOutDate for sorting status-games by time-remaining
     - TimeOutDate is changed if player starts or changes the length of vacation:
       - if player is on vacation, the remaining-time changes as well,
         because the TimeOutDate is an absolute date.
       - if user starts vacation, the TimeOutDate of all games-to-move for that user is extended
         by the number of ticks representing the length of vacation-days.
       - if user changes the length of vacation, the TimeOutDate of all the games-to-move
         for that user is adjusted by the respective number of ticks.
       - if the vacation of a user ends, the TimeOutDate is not changed,
         because the additional time (gained by vacation) is consumed.
     - TimeOutDate is not changed if player changes night-time or timezone, because current game-clocks
     - stopped weekend-clocks are not handled for TimeOutDate, see field-doc in 'specs/db/table-Games.txt'
     - fixed adjusting TimeOutDate on adding-time to game by opponent
     - fixed handling of Games.ClockUsed < 0 (vacation) and relative Games.LastTicks for that case

   - fix-games-timeleft-script: show value-diff for changed Games.TimeOutDate-field
   - fix bug: needed ref-args in constructor of GameAddTime for access on passed-in var-ref $game_row
   - cleanup: simplified and sync'ed code to determine game-clock/last-ticks/time-out-date
   - cleanup: replaced game-row vars (Black/White)onvacation -> Black|White_OnVacation

   - optimized clock-tick-loading
     - changing default to USE cache now to avoid same clock is loaded multiple-times within same session
     - added method to get singleton of clock-cache

   * include/table_columns.php (Table.register_filter):
   - fix bug: needed ref-args

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     specs/db/dragon-ddl.sql:
   - optimization: speed up forum-search on specific user
-----------
-- speed up forum-search on specific user
ALTER TABLE Posts
   ADD KEY User_ID (User_ID);
-----------

   * list_contacts.php, NEWS:
   - added table-navigation for contact-list

2012-07-05 juga

   * tournaments/include/tournament_pool.php (TournamentPool.count_tournament_pool_users,
       ~.count_tournament_pool_games),
     tournaments/include/tournament_participant.php (TournamentParticipant.count_tournament_participants),
     statistics.php (show_stats_default, show_stats_user_countries),
     statratingspng.php (get_ratings_data),
     scripts/browser_stats.php:
   - optimized GROUP-BY select-queries by using SQL_SMALL_RESULT indicating small resultset

   * include/mail_functions.php (html_entity_decode, mail_link, mail_strip_html),
     include/config.php (EMAIL_ADMINS),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     specs/db/dragon-ddl.sql, halfhourly_cron.php, NEWS:
   - fix bug: avoid concurrent start of halfhourly-cron-script alerting admin per mail
     with new EMAIL_ADMINS-config to check problem
   - optimized mail-notifications:
     - speed up sending mail-notifications by adding index on Players.Notify-field
     - directly send notifications for users with Players.Notify='NEXT'
     - pre-load users to notify and their games to release db-resultset as soon as possible
       because loop can take quite some time
     - load game-board only if needed and not for any move-notify, that is only if user actually
       wants BOARD-notifications including last game-message
     - minor: avoid board-move-fix when board is loaded
   - added LF after game-board in message
   - refactored mail-funcs from 'halfhourly_cron.php' into 'include/mail_functions.php'
   - minor change (used consts, detailed error-labels, strpos-checks, if-to-ternary-op, string-formatting)
-----------
-- speed up sending mail-notifications in halfhourly-cron-script
ALTER TABLE Players
   ADD KEY Notify (Notify) ;
-----------

2012-07-04 juga

   * include/message_functions.php (game_settings_form, game_info_table),
     include/make_game.php (accept_invite_game),
     message.php:
   - fix bug: use opponents jigo-mode for view/dispute of invitation with fair-komi sent to me,
     but using my jigo-mode viewing invitation sent by me

   * game_rematch.php:
   - fix bug: Correct handicap-type if stored GameSetup is not from logged-in user
     for player or non-player, in which case the fix-color and divide&choose fair-komi
     needed compensation

   * include/game_functions.php (GameSetup.get_htype_swapped, ~.determine_handicaptype;
       get_handicaptype_for_invite),
     include/message_functions.php (game_settings_form, game_info_table),
     include/make_game.php (make_invite_game, accept_invite_game),
     include/quick/quick_message.php (QuickHandlerMessage.process_cmd_info),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
   - fix bug: wrong color chosen on accepting game-invitation and shown for viewing-invitation
     and on dispute, had to take swapped handicap-type of opponennts choice
   - fix bug: handle non-migrated old game-invitations with fix-color-setting stored with Games.ToMove_ID>0,
     then determine color from Games.Black/White_ID
   - write Games.Starttime to indicate start of invitation
-----------
-- fix Starttime for invitations
UPDATE Games
   SET Starttime=Lastchanged WHERE Status='INVITED' AND Starttime=0 ;
-----------

2012-07-03 juga

   * include/classlib_game.php (GameSnapshot.init_game_snapshot),
     include/make_game.php (create_game):
   - set Games.SnapShot also for empty boards

2012-07-02 juga

   * send_new_password.phpA:
   - fix bug: must allow sending-password for not-logged-in users

   * include/make_game.php (accept_invite_game),
     include/message_functions.php (game_info_table),
     include/wroom_control.php (WaitingroomControl.join_waitingroom_game),
     tournaments/include/tournament_rules.php (TournamentRules.prepare_create_game_row),
     waiting_room.php (determine_color):
   - fix bug: show nigiri-color-icon for even-game with conventional-handicap-setting

   * include/game_functions.php (GameNotify.get_text_game_result;
       build_suggestion_shortinfo, get_colortext_probable):
   - fix bug: do not send players final private message in game-end-message to observers,
     but include if there are hidden comments
   - fix bug: show nigiri-color-icon for even-game with conventional-handicap-setting

   * include/rating.php (suggest_conventional):
   - fix bug: revert handicap and komi calculations for conventional-handicap game-setting
     by using nigiri on even game with rating-diff < 0.5 instead of only on exactly same rating
     and correcting handicap-stone from 1 to 0 only for handicap-games

   * include/connect2mysql.php (writeIpStats),
     scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     specs/db/dragon-ddl.sql:
   - added creation-date for cleanup of IpStats-table
-----------
-- add creation-date for cleanup
ALTER TABLE IpStats
   ADD Created datetime NOT NULL default '0000-00-00 00:00:00' AFTER Counter,
   ADD KEY Created (Created) ;
-----------

2012-06-23 juga

   * message.php:
   - added Shapes-link on SendMsg-page for invitation-related messages

   * forum/forum_functions.php (DisplayForum.draw_overview, ~.to_string),
     include/utilities.php (cut_str):
   - fix bug: do not cut HTML-entities in two

   * include/globals.php (DASH_SPACING),
     forum/forum_functions.php (ForumThread.get_thread_hits),
     forum/read.php:
   - show thread-hits on thread-posts-view

   * include/game_functions.php (adjust_handicap):
   - fix bug for adjusting handicap: replace handicap of 1 stone with 0 stones

   * templates.php (check_save_template):
   - when replacing existing template the name is taken from the existing template
     if not given to rename

   * include/game_functions.php (parse_waiting_room_rating_range, append_form_add_waiting_room_game),
     new_game.php (handle_add_game):
   - fix bug saving new-game-template with required rating-range:
     - restricting min/max-rating when saving as and reading from template
     - don't adjust min/max-rating by half a rank when saving as template
-----------
# fix existing Profiles (Type=29) by rounding to 100-value for min/max-rating limits
-----------

   * include/sgf_builder.php (class SgfBuilder, ~.echo_sgf, ~.sgf_echo_prop, ~.sgf_echo_comment,
       ~.build_sgf_start, ~.build_sgf_moves, ~.build_sgf_result, ~.build_sgf_end):
   - fix bug: omit double empty comment-property C[]

   * include/gui_bulletin.php (GuiBulletin.check_expiretime),
     include/db/bulletin.php (Bulletin.is_user_bulletin),
     admin_bulletin.php (parse_edit_form),
     edit_bulletin.php (parse_edit_form),
     specs/db/table-Bulletins.txt:
   - fix bug: expire-time for admin-bulletin is optional, but mandatory for user-bulletin
   - reduced min. subject-length: 8 -> 4

   * show_games.php:
   - fix bug for user's finished games:
     opponent- and user-rating-diff were switched using the wrong SQL

   * game.php (draw_game_info):
   - fix bug for MP-game:
     - show hidden-comments to player of a particular move with move-message
     - hide hidden-comments to others

   * game_players.php (check_invite):
   - fix bug for MP-game: handle as error when empty user-handle is used for invitation

   * include/game_functions.php (MultiPlayerGame.init_multi_player_game,
       ~.join_waitingroom_game, ~.load_master_uid):
   - clear QST-cache (quick-status) for MP-games on writing-operations:
     start MP-game, join MP-game

   * show_games.php:
   - typo in bottom-links: Users -> User's
-----------
# recreate translations with translation-scripts
-----------

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
-----------
-- rename users with spaces in Handle: 1. find them, 2. contact them, 3. rename Handle via user-admin-page
SELECT ID, Handle, Email, Lastaccess, Running, LastMove
   FROM Players WHERE Handle LIKE '% %' ORDER BY Lastaccess ;
-----------

2012-06-17 juga

   * admin.php, admin_admins.php, admin_faq.php, admin_game.php, admin_password.php,
     admin_rating.php, admin_show_adminlog.php, admin_show_errorlog.php, admin_show_faqlog.php,
     admin_show_users.php, admin_translators.php, admin_users.php, translate.php,
     forum/admin.php, forum/admin_show_forumlog.php,
     scripts/fix_game_snapshot.php, scripts/README.developers:
   - reverted translations for admin-pages to strip-off '#'-suffix in texts

   * include/classlib_game.php (NextGameOrder.persist_game_priority),
     include/game_functions.php (GameHelper.delete_running_game; GameFinalizer.finish_game),
     include/message_functions.php (update_count_message_new),
     include/std_functions.php (send_message, clear_cache_quick_status),
     include/db/bulletin.php (Bulletin.mark_bulletin_as_read),
     include/quick/quick_game.php (QuickHandlerGame.process_cmd_play),
     include/globals.php (QST_CACHE_...),
     include/make_game.php (create_game),
     game_players.php (accept_invite, reject_invite, start_multi_player_game),
     clock_tick.php (handle_game_timeouts),
     confirm.php (do_komi_save),
     admin_game.php, quick_play.php:
   - clear QST-cache (quick-status) on some writing-operations for:
     - operations are covered by all interfaces: web-site, quick-play and quick-do-suite
     - appending "CLEAR block" (block = B/M/G/MPG) to existing QST-cache-file will invalidate
       block-specific cache-portion and reload the specific block when quick-status is used

     - "CLEAR G" for status-games on:
       - start a game by joining waiting-room-game or accepting invitation or started MP-game
       - finish a running game by user or timeout
       - delete a running game by user or admin
       - move in a running game (play, resign, delete, pass, score)
       - save change during fair-komi negotation
       - changing the game-priority for ordering status-games
     - "CLEAR M" for private-messages on:
       - new message of single and bulk type for sender and receivers
       - read message (moving it away from NEW-folder)
       - move message into different folder
     - "CLEAR B" for bulletins on:
       - mark bulletin as read
     - "CLEAR MPG" for multi-player-games on:
       - accept or reject invitation
       - start MP-game

   * quick_status.php (append_data, print_bulletins, print_messages, print_status_games,
       print_mpg, parse_cache_content),
     specs/quick_suite.txt:
   - clear QST-cache (quick-status) on some writing-operations:
     - changed cache-filename for quick-status using Players.ID instead of Handle for easier clearing of cache,
     - execute authentication & authorisation before accessing cache-file to ensure correct user-id for script
     - invalidate block-specific cache if "CLEAR block"-instruction found in user-specific QST-cache-file
     - appending "CLEAR block" (block = B/M/G/MPG) to existing QST-cache-file will invalidate block-specific
       cache-portion and reload the specific block when quick-status is used
     - 'excessive_usage'-warning is only given if cache-portions are not invalidated and quick-status called
       again before 1 minute passed since last usage, in which case the full cache-data is returned
     - writing IpStats-table with page-key 'QSTC' for request that returns only cached data,
       'QST' if data is loaded
     - clear datablocks before loading new block-specific data
   - minor cleanup: renamed CACHE_* const to QST_CACHE_* for global-use, moved local funcs to bottom
-----------
# delete existing QST-cache-files: execute 'scripts/clear_datastore.php?subdir=qst&del=1'
-----------

   * game_players.php (build_game_settings):
   - overlooked texts for translation
-----------
# recreate translations with translation-scripts
-----------

   * forum/forum_functions.php (ForumPost.build_query_sql), forum/search.php:
   - fix bug: fixed forum-posts ordered by modification-date using MAX(Posts.Time,Posts.Lastedited),
     former order by Posts.Lastchanged was only date of threads

2012-06-16 juga

   * quick_play.php, scripts/updates/database_changes_1_0_14_to_1_0_15.mysql:
   - set Players.LastQuickAccess if submitting move with quick-play-page
-----------
-- fix Players.LastQuickAccess if LastMove > Lastaccess
SELECT ID, Handle, LastQuickAccess, Lastaccess, LastMove, TIMEDIFF(Lastaccess,LastMove) AS TDiff, TIME_TO_SEC(timediff(Lastaccess,LastMove)) AS TSec
   FROM Players WHERE LastMove >0 AND LastQuickAccess < LastMove HAVING TSec < 0 ;
UPDATE Players
   SET LastQuickAccess = LastMove WHERE LastMove >0 AND LastQuickAccess < LastMove AND TIME_TO_SEC(TIMEDIFF(Lastaccess,LastMove)) < 0 ;
-----------

   * game.php (draw_message_box), confirm.php, NEWS:
   - restored old way for game-submit-move to next-game / to status-page, removed stay-on-board option
   - widened game move-message-box: 60 -> 70

   * features/vote_feature.php:
   - show reason for user if and why voting is not possible

   * admin_admins.php, admin_do_translators.php, admin_faq.php, admin_game.php, admin_password.php,
     admin_rating.php, admin_show_adminlog.php, admin_show_errorlog.php, admin_show_faqlog.php,
     admin_show_users.php, admin_translators.php, admin_users.php, translate.php, update_translation.php,
     forum/admin.php, forum/admin_show_forumlog.php, scripts/check_block_ip.php,
     scripts/clear_datastore.php, scripts/convert_from_old_forum.php, scripts/convert_posindex.php,
     scripts/data_export.php, scripts/data_report.php, scripts/fix_game_snapshot.php,
     scripts/fix_games_timeleft.php, scripts/forum_consistency.php, scripts/game_consistency.php,
     scripts/generate_translation_texts.php, scripts/index.php, scripts/mailtest.php,
     scripts/make_handicap_pattern.php, scripts/message_consistency.php, scripts/player_consistency.php,
     scripts/recalculate_ratings2.php, scripts/server-info.php, scripts/start_frozen_clocks.php,
     scripts/tournament_consistency.php, scripts/translation_consistency.php, scripts/update_translation_pages.php,
     scripts/voting_consistency.php, scripts/obsolete/lang_edit.php,
     scripts/updates/fix_game_comments-1_0_15.php, scripts/updates/fix_message_thread-1_0_15.php:
   - forbid guest-user to use admin-pages by adding additional guest-check

   * include/error_functions.php (need_db_errorlog), specs/quick_suite.txt,
     confirm.php, edit_folders.php, edit_rating.php, edit_vacation.php, game.php, game_players.php,
     join_waitingroom_game.php, new_game.php, old_goban_editor.php, quick_do.php, quick_play.php,
     send_new_password.php, templates.php, tournaments/wizard.php, scripts/README.developers:
   - don't create ErrorLog-entry if guest-user is not allowed to execute operation
   - forbid write-operations by guest-user with 'not_allowed_for_guest'-error
   - forbid usage of some quick-suite-pages by guest-user

   * admin.php, admin_game.php, admin_password.php, admin_rating.php, admin_show_adminlog.php,
     admin_show_errorlog.php, admin_show_faqlog.php, admin_show_users.php, admin_users.php,
     forum/admin.php, forum/admin_show_forumlog.php,
     include/db/ratingchangeadmin.php,
     scripts/fix_game_snapshot.php:
   - removed/commented-out translations for admin-pages
-----------
# recreate translations with translation-scripts
-----------

2012-06-10 juga

   * NEWS:
   - comment out some (disabled) tournament-related features
   - correct game-invitation cleanup: 3 -> 6 months

   * edit_picture.php:
   - added copyright-note for uploading user-picture

   * game.php:
   - fix bug: showed correct user-rating for MP-game on game-page who last-moved
     in players-info-table, was showing rating of logged-in user

   * include/game_functions.php (get_color_titles),
     status.php (load_games_to_move),
     show_games.php:
   - added hover-text on color-images for status-games
   - use nigiri-image for status-games in fair-komi-negotiation
   - fix bug: hover-text about player-to-move of colors-image on my running-games was wrong
   - fix bug: use nigiri-image for games in fair-komi-negotiation

   * include/std_functions.php (user_reference):
   - user-ref: escape user-id/handle in sql

   * include/table_columns.php (Table.make_table_filter):
   - fix bug: removed "Button"-class on <td>-element with table-filter,
     showed button-image-part in some browsers

   * include/time_functions.php (echo_onvacation):
   - fix bug: corrected original text to allow repositioning of words
     in translation of "%s left"-text, e.g. required in Russian language

   * include/utilities.php (basic_safe):
   - fix bug: some browsers (IE) follow the HTML-standard,
     so it doesn't show "&apos;" as apostroph, so replaced with "&#39;"


2012-06-10 juga

   * include/quick_common.php ($clocks_stopped),
     clock_tick.php (clkrng, handle_game_timeouts):
   - added switch $clocks_stopped to stop clocks in 'include/quick_common.php'
     to have a safety-net after some major upgrade

   * include/time_functions.php (get_clock_ticks, time_left_ticksdate),
     include/classlib_game.php (NextGameOrder.make_timeout_date),
     include/game_functions.php (GameHelper.update_clock;
       FairKomiNegotiation.save_komi, ~.start_fairkomi_game),
     include/make_game.php (accept_invite_game, create_game),
     include/quick/quick_game.php (QuickHandlerGame.process_cmd_play),
     tournaments/game_admin.php (draw_add_time),
     confirm.php, game.php, gameinfo.php, quick_play.php:
   - added debug-location for reading clock-ticks

   * game.php:
   - show "other scoring" on devel-server only if game in SCORE-/FINISHED-phase

   * gameinfo.php:
   - removed extra-space for double-game

   * quick_play.php:
   - fix bug: missed X_Black/WhiteClock, so replaced loading with GameHelper::load_game_row()
   - fix bug: missed declaration of $message_query

   * include/make_game.php (accept_invite_game, create_game):
   - fix bug: missed GameSetup on creating double-game when accepting game-invitation

   * scripts/game_consistency.php:
   - fix bug: corrected table-alias usage for unknown column

   * include/db/games.php (Games, ~.insert, ~.update, ~.new_from_row):
   - fix bug: Games.Starttime/Lastchanged are not the typical db-entity
     Created/Lastchanged fields, but start-time after setup & last-moved-date respectively,
     therefore remove auto-setting of Starttime & Lastchanged field in insert() & update()
   - fix bug: used db-entity standard datetime-field prefix -> X_Starttime/X_Lastchanged

   * include/db/waitingroom.php (Waitingroom.insert, update):
   - fix bug: removed non-existing Lastchanged-field

   * scripts/game_consistency.php:
   - commented out & added TODO for wrong datetime-handling for consistency-check
     of Starttime>Lastchanged

   * snapshot.php:
   - updated snapshot-page for release 1.0.15
   - commented out current CVS-version as that version is often not stable

   * scripts/updates/roadmap_1_0_14_to_1_0_15.txt:
   - added mysqldump-command to export translation-data

   * scripts/updates/database_changes_1_0_14_to_1_0_15.mysql,
     scripts/updates/other_changes_1_0_14_to_1_0_15.txt,
     scripts/updates/ChangeLog_1_0_15,
     specs/db/dragon-ddl.sql:
   - sync'ed changes from LIVE-update from 10-Jun-2012
   - sync'ed DDL from LIVE-database
   - fix missing db-update: TournamentLadderProps.ChallengeRangeAbsolute signed

   * include/quick_common.php:
   - disabled server-down with $is_down=false for LIVE-update

   * scripts/fix_game_snapshot.php (fix_single_game, bulk_fix_missing_game_snapshots):
   - fix bug: Games-obj-update() destroyed Starttime/LastChanged-field
   - fix bug: allow single fix also if snapshot not set
   - fix bug: declare global-var for processing ALL games
   - collect game-ids, that coulnd't be processed

2012-06-08 juga

   * scripts/obsolete/*.php, scripts/obsolete/README.txt:
   - found some old scripts on live-server, probably obsolete

   * include/std_functions.php (send_message):
   - bugfix: increase CountMsgNew only if >=0

   * NEWS:
   - prepare release-notes for DGS 1.0.15
     - extended & corrected texts
     - commented out most references to disabled tournaments-features & chinese-ruleset

   * links.php:
   - fix broken links: IGF, IGS

   * include/quick/quick_wroom.php (QuickHandlerWaitingroom.process_cmd_info):
   - comment out TODO-fields: restrictions, calc_type/color/handicap/komi

   * include/config.php (ALLOW_RULESET_CHINESE),
     include/game_functions.php (GameSetupBuilder.build_url_game_basics),
     include/make_game.php (make_invite_game_setup, create_game),
     include/message_functions.php (game_settings_form),
     include/db/games.php (Games.setRuleset),
     tournaments/include/tournament_rules.php (TournamentRules.setRuleset,
       ~.convertEditForm_to_TournamentRules),
     new_game.php, NEWS:
   - disable chinese-ruleset till implementation clarified,
     error or enforce japanese-ruleset as default

2012-06-07 juga

   * include/quick_common.php ($is_down, $is_down_message):
   - sync is_down=true & is_down_message with stable-branch to prepare server-upgrade

   * include/std_functions.php (start_page, show_maintenance_page, is_logged_in),
     include/connect2mysql.php (admin_log, writeIpStats, db_query),
     include/error_functions.php (err_log),
     error.php, game.php, login.php, sgf.php:
   - improve handling if server is down to prevent db-updates and useless db-connections:
     - don't count quota
     - allow login for admins
     - prevent writing AdminLog & ErrorLog
     - db_query: allow only SELECTs, no writing-operations allowed
     - game-page: show maintenance page to prevent useless db-connections
     - sgf: return server_down-error
   - added logging of HTTP-headers for users: Accept-Language & Accept-Charset to support UTF-8 migration

   * scripts/server-info.php:
   - added login-check to allow calling if server-down

   * quick_do.php, quick_play.php, quick_status.php:
   - replace LFs in server-down-message

   * scripts/updates/roadmap_1_0_14_to_1_0_15.txt:
   - roadmap for upgrading to DGS 1.0.15

2012-06-06 juga

   * include/message_functions.php (game_settings_form), NEWS:
   - changed default time-settings: Fischer time 14d+1 -> 30d + 1d

