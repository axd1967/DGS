------------------------------------------------------------------
General infos
------------------------------------------------------------------
changelog reference at:
http://www.gnu.org/prep/standards/html_node/Change-Logs.html

previous server update: 2006-09
release [2006-08-07] - DGS 1.0.12 - CVS-tag [DGS-stable-200608]

-----
quick INFO:

2007-02-03 rodival
   I've reformatted the changelog file with last changes at top.
   I'm working on the bad centered alignement of FAQ, docs and other pages.

2007-07-08 juga
   Currently working on known filter-bugs.

-----
quick TODO:

------------------------------------------------------------------

------------------------------------------------------------------
Changelog
------------------------------------------------------------------

2007-07-23 rodival

   * include/make_game.php,
     send_message.php, join_waitingroom_game.php, error.php:
   - problem of "bad Running count" fix: more checks to find if the
     game had already been accepted.

   * game.php:
   - minor W3C compliance fix.

   * include/std_functions.php:
   - added an easier way to configure the vault parameters

   * edit_profile.php:
   - added the 'x' access key to the submit button

   * skins/dragon/screen.css, game.php, include/board.php:
   - forum list and board page CSS adjustments
   - players rating info fixed to CurrentRating/EndRating
     added StartRating in a CSS hidden element

2007-07-22 rodival

   * include/faq_functions.php, faq.php, admin_faq.php:
   - enhanced the admin_faq preview.
     added the file faq_functions.php for the common functions of the
     faq scripts.
     removed the T_() from admin_faq.php

   * include/form_functions.php:
   - removed useless include, added a comment

2007-07-22 juga

   * include/message_functions.php (message_list_table):
   - set correspondent for server-message or if unknown

   * game.php, message.php, search_messages.php, send_message.php,
     include/game_functions.php (allow_add_time_opponent, add_time_opponent),
     include/message_functions.php (message_list_table):
   - added support to add time for opponent
-----------
ALTER TABLE `Messages`
 CHANGE `Type` `Type` enum('NORMAL','INVITATION','ACCEPTED','DECLINED','DELETED','DISPUTED','RESULT','ADDTIME') NOT NULL default 'NORMAL';
-----------

   * error.php:
   - fixed typos

2007-07-22 rodival

   * include/countries.php, include/filter.php:
   - removed the obsolet 'Serbia and Montenegro (Yugoslavia)'
     from countries list

   * search_messages.php, docs.php, translate.php:
   - minor comments adjustements

   * include/error_functions.php (echo_error_list),
     clock_tick.php, halfhourly_cron.php, daily_cron.php:
   - enhanced a little the error handling of cron jobs
     added an argument $prefix to echo_error_list()
     added completion flags in the cron scripts (using the Ticks
     field of their owned clock)

2007-07-22 juga

   * links.php:
   - removed invalid and corrected existing links and texts
   - added IGF as mediator to most international go associations
   - added OGS

2007-07-21 juga

   * forum/search.php, include/filter.php, include/form_functions.php,
     include/tokenizer.php, opponents.php, search_messages.php,
     show_games.php, site_map.php:
   - corrected translated texts (typo, upper/lower-case,
     use '#'-notation to avoid ambiguities and allow notes-like namespaces)

   * docs.php:
   - added NEWS as "Release notes"

   * translate.php:
   - more instructive text about '#'-notation

   * admin_faq.php:
   - mark "current" entry with green marker
   - moved marker in front of entries (inbetween hard to see)
   - added cookie-based move-distance for up-/down-move of entries
     resettable with 0 to default 1

   * include/message_functions.php (message_list_table),
     search_messages.php:
   - abstracted details of types-filter to: Private, Game messages
   - moved 'Myself' into direction-column as message with from & to
     changed texts of direction-filter: Received/Sent -> From/To
   - left-aligned text in colored folder-checkboxes
   - removed bottom-links (Browser/Edit folders),
     because redundant with main-menu-links

   * admin_faq.php:
   - added preview-option in new/edit-entry page
   - added search to find texts also in hidden entries
   - locate page roughly where recent working took place using anchors
   - overworked instructions, some more comments
   - minor layout-adjustments: submit-button, labels, alignment

   * include/form_functions.php:
   - allows to omit maxlength of INPUTBOX-element specifying as <0

2007-07-21 rodival

   * include/std_functions.php, admin_admins.php:
   - introduced 2 new admins classes: developers and skinners
-----------
UPDATE `Players`
 SET `Adminlevel`=-1 WHERE `ID`=2 LIMIT 1 ;
-----------

   * edit_profile.php:
   - reduced the access to the skins (temporary)

   * translate.php, update_translation.php,
     include/make_translationfiles.php:
   - gave an access to all languages to the ADMIN_TRANSLATORS

   * include/std_functions.php, admin_do_translators.php, admin.php,
     admin_faq.php, admin_password.php, admin_translators.php,
     change_password.php, people.php, send_new_password.php, status.php,
   * scripts/convert_from_old_forum.php, scripts/convert_posindex.php,
     scripts/data_export.php, scripts/data_report.php,
     scripts/FAQtransl_consistency.php, scripts/game_consistency.php,
     scripts/generate_translation_texts.php, scripts/mailtest.php,
     scripts/message_consistency.php, scripts/player_consistency.php,
     scripts/recalculate_ratings2.php, scripts/start_frozen_clocks.php,
     scripts/update_translation_pages.php,
   * forum/admin.php, forum/index.php, forum/list.php, forum/read.php,
     forum/search.php:
   - removed the global $admin_level (use $player_row['admin_level'] instead)
   - normalization of each places where $player_row['admin_level'] is used

2007-07-20 rodival

   * forum/forum_functions.php, skins/dragon/screen.css:
   - added a "go back to first new" link at bottom of lists
     CSSed the "new" links
   - adjusted the MarkTerm colors

   * admin_password.php, send_new_password.php, forgot.php:
   - added a way to overwrite the current new password process for admins.

   * include/make_translationfiles.php, admin_faq.php, faq.php,
     translate.php, update_translation.php:
   - add of a better 'translated' flags management between the translators
     and the FAQ admins.
     now, the different languages may set their translated flag independently.
-----------
ALTER TABLE `Translations`
 ADD `Translated` ENUM( 'Y', 'N') NOT NULL DEFAULT 'N' AFTER `Text` ;
UPDATE `Translations` SET `Translated` = 'Y';
-----------
   - changed the 'hidden' and 'translatable' buttons of admin_faq.php
     from a toggle process to a set/reset process. Basicaly, they acts
     the same way but a simple refresh of the page will not "toggle-back"
     the option now.
   - modified the "move" part of admin_faq.php to allow a move greater
     than 1: admin_faq.php?move=u&dir=3 now move the item 3 steps highter.
     alas, actualy, this is only usable my manualy modifying the URL.

   * scripts/FAQtransl_consistency.php:
   - added file (as a seed for more)

2007-07-19 rodival

   * admin_translators.php, admin_do_translators.php:
   - added a 'Known languages' listing

2007-07-18 juga

   * change_profile.php, edit_profile.php,
     include/std_functions.php (get_maxrows, build_maxrows_array),
     include/table_columns.php:
   - added TableMaxRows (can be locally changed using cookie),
     store table-max-rows in new column Players.TableMaxRows
   - Table: URL-var 'maxrows' overrules user-prefs for max-rows
   - changed default for RowsPerPage: 50 -> 20
   - added limits for profiled maxrows: MAXROWS_PER_PAGE_PROFILE
   - added maxrows-default for get_maxrows(): MAXROWS_PER_PAGE_DEFAULT
   - added default rows-limit for build_maxrows_array() to restrict
     max-rows in edit-profile to MAXROWS_PER_PAGE [50]
-----------
ALTER TABLE `Players`
 ADD `TableMaxRows` smallint(5) unsigned default 20 NOT NULL;
-----------

   * list_messages.php:
   - reverted bottom-link to verbal form: Search messages (according to site-map)

   * include/filter.php (add_or_del_filter):
   - removed todo to save filter (for now)


   * include/filter.php (is_static),
     code_examples/filter_example.php, code_examples/filter_example2.php:
   - added global const FILTER_CONF_FORCE_STATIC making all
     filter-elements static (no filter-hide, set at the moment),
     added filter-config FC_HIDE to overrule that const
   - use default size 8 for Rating-Filters

   * opponents.php, users.php, waiting_room.php:
   - added filter-config FC_HIDE on Country-filter
   - use (default) size 8 for Rating-Filters

   * search_messages.php:
   - SQL-optimization: replaced 'Game_ID<>0' with 'Game_ID>0'

2007-07-18 rodival

   * include/std_functions.php, include/quick_common.php:
   - moved the IS_RUNNING_GAME constant in quick_common.php to make it
     usable by the rss and wap stuff and the 'quick_*' suite.

   * include/config.php:
   - moved a line closer to its friends.

   * include/message_functions.php, include/countries.php, site_map.php:
   - minor fixes, comments and translated strings.

2007-07-18 juga

   * opponents.php, user_stats.php, site_map.php, userinfo.php, users.php,
     include/filter.php, code_examples/filter_example.php:
   - "renamed" user_stats.php (removed) to opponents.php (added),
     copied full CVS-log from user_stats.php on initial revision


   * show_games.php, user_stats.php:
   - optimized SQL replacing 'OR'-operator with UNION-based SQL-query,
     activated with global const ALLOW_SQL_UNION in "include/config.php",
     needed to adjust sort-fieldnames (UNION forces to use fields from SELECT)
   - used more detailed bottom link-texts for games-page to show
     where you are and where you can go (showing my/all/other-users games,
     without adding more links), for observer-game-view added additional
     links to show all games (preserving shared URL-vars)

   * include/config.php (ALLOW_SQL_UNION):
   - added ALLOW_SQL_UNION as on/off-switch to control UNION-support,
     default now is to support UNION-queries


   * search_messages.php:
   - avoid SQL-'OR'-operator by reducing Correspondent-filter on Players.Handle,
     may later be reverted by using UNION-based-query
   - extended filters syntax-description with hint to what can be searched (Userid)
   - changed bottom-link to 'Browse folders'

   * include/message_functions.php (message_list_table):
   - changed message-list for search-messages-page to show
     full user-name with handle and link to userinfo,
     added message-link on subject

   * include/filter.php (get_syntax_description, get_syntax_hint),
     specs/filters.txt, code_examples/filter_example2.php:
   - added filter-config FC_SYNTAX_HINT allowing to extend a filters
     hover-text-syntax-description
   - added example for filter-config FC_SYNTAX_HINT

2007-07-17 juga

   * include/std_functions.php (not_in_clause):
   - added constant SQL-clause-part IS_RUNNING_GAME to apply for Games.Status
     to optimize SQL getting rid of '!='-operator to use index
   - changed func: build_not_in_clausepart(..) -> not_in_clause( enum-array, var-args )
     to build optimized 'NOT IN'-surrogate with IN for any table-column
   - removed func: not_in_Games_Status(), use not_in_clause( $ENUM_GAMES_STATUS, ...)

   * clock_tick.php, confirm.php, daily_cron.php, edit_vacation.php,
     halfhourly_cron.php, quick_status.php, show_games.php, status.php,
     scripts/player_consistency.php, scripts/start_frozen_clocks.php,
     user_stats.php, rss/status.php, wap/status.php:
   - optimized SQL getting rid of '!='-operator to use index on Games.Status,
     replaced using SQL-clause-part IS_RUNNING_GAME

   * forum/search.php:
   - changed Author-filter:
     only filtering on Players.Handle, removed OR with Players.Name
     adjusted Text by adding '(Userid)'

2007-07-16 juga

   * include/std_functions.php (build_not_in_clausepart, not_in_Games_Status):
   - added funcs to provide optimized SQL-part IN-clause using index,
     but allowing to express it with negated values,
     e.g. Status not_in_Games_Status('INVITE') <=> Status != 'INVITE'
     <=> Status NOT IN ('INVITE')
     !! all '!=' and 'NOT IN' SQL-parts should be replaced if the
     databases index cardinality on that field is >2 or at least if >3

2007-07-16 rodival

   * include/std_functions.php (send_message, delete_all_observers):
   - ajusted the arguments of send_message() including the previous
     message modifications
     enabled the use of send_message()
     changed the escaped state of the Text argument of delete_all_observers()
     now it should NOT be escaped before the call.

   * send_message.php, join_waitingroom_game.php, clock_tick.php:
   - enabled the use of send_message()

   * confirm.php:
   - enabled the use of send_message() and notify()

   * include/std_functions.php, include/make_game.php (create_game),
     include/rating.php (get_rating_at, convert_to_rating, read_rating),
     include/filter.php (convert_rank):
   - introduced the OUT_OF_RATING constant (ominous limit for ratings).
     now read_rating() always return a numeric value.

   * skins/dragon/screen.css:
   - adjusted the size of the separations of the forum posts.
     added some comments

   * user_stats.php, show_games.php:
   - reversed the "NOT IN ('INVITED','FINISHED')" clauses

2007-07-16 juga

   * include/std_classes.php (get_select, get_select_normal),
     code_examples/query_sql.php:
   - QuerySQL: added basic UNION-support allowing non-template-WHERE-clause,
     specify with SQLP_UNION_WHERE; added example

2007-07-15 juga

   * include/filter_functions.php (createTokenizerConfig),
     include/filter_parser.php (TextParser.parse):
   - changed default filter-quote-type: use quoting using single-quotes "'"
   - fixed bug: wildcard '*' now has higher precedence over separator '-',
     can be controlled using TEXTPARSER_PRECEDENCE_SEP-flag

   * skins/dragon/screen.css:
   - removed no longer needed style for Filter <sup> after using
     Filter-hide-image

   * users.php:
   - widened input-box-size for Rating-filter

2007-07-15 rodival

   * include/filter.php (build_generic_selectbox_elem):
   - moved the "\n" before "</select>" to avoid a spacing effect after the
     select box.

   * include/table_columns.php (make_table_filter),
     skins/dragon/screen.css:
   - inserted the CSSed "hide" buttons for the filters, the same way those
     from the column headers.

2007-07-15 juga

   * include/filter.php (parse_value), code_examples/filter_example2.php:
   - FilterRelativeDate: allowed '<unit' as additional syntax

2007-07-14 juga

   * include/std_classes.php (merge_from_parts):
   - QuerySQL: assure mysql5.0-compatibility by replacing ','-join
     with INNER JOIN

   * search_messages.php:
   - layout-changes:
     - use smaller padding (6 -> 4px) for folder-boxes
     - compact form and page (reorder filters and less empty rows)

   * user_stats.php, waiting_room.php:
   - compact form and page (less empty rows)

   * users.php:
   - use proper upper/lower-case on title

   * forum/search.php:
   - removed anchor on table-search (filters can have errors)

   * include/table_columns.php, skins/dragon/screen.css:
   - compact table (less empty rows)
   - right-align paging next-link

2007-07-14 rodival

   * include/table_columns.php:
   - added the set_sort() function to force the table sort

   * status.php, users.php, user_stats.php:
   - managed the sort arguments the new way.

   * include/message_functions.php, include/filter.php, list_messages.php,
     search_messages.php, site_map.php, forum/search.php:
   - adjusted some comments and T_() strings

   * include/filter.php (get_submit_elements),
     include/table_columns.php (make_add_column_form),
     forum/search.php:
   - a proposition for the get_submit_elements() function: added a
     $filtertype argument to manage the buttons name.
     modified the other files accordingly.

2007-07-13 juga

   * include/filter.php (FilterMysqlMatch.get_terms, get_submit_elements):
   - bugfix get_terms() for Mysql-match:
     filter shouldn't return terms if inactive
   - renamed start-/reset-search -> apply/reset-filter
   - comment for minimum mysql-version for fulltext-search:
     mysql 4.0.1 (boolean-mode), 4.1.1 (query-expansion)

2007-07-12 rodival

   * include/std_functions.php (parse_tags_safe, parse_html_safe),
     include/message_functions.php (message_info_table,
     message_list_table),
   * forum/list.php, forum/forum_functions.php (draw_post,
     display_posts_pending_approval),
     skins/dragon/screen.css:
   - moved the mark_terms feature into the make_html_safe process.
     added the $mark_terms argument to parse_html_safe() and make_html_safe()
     removed the <term> pseudo-tag previously used to mark the terms
     removed the now obsolete mark_terms() function
   - introduced the SUBJECT_HTML constant to highlight to common "style"
     of the subjects.

   * forum/search.php, forum/forum_functions.php (make_link_array),
     include/filter.php:
   - changed the type of the search form to POST because a GET one plus
     a url #id part make the buttons inactive if no fields have changed.
     added a 'x' accesskey to the main button of the search page
     fixed some minor weakness.
     a try to include a "moderator" search but this need to define a new
     subclass in draw_post: added a comment and postponed it.

   * include/table_columns.php, faq.php, waiting_room.php,
     forum/read.php:
   - minor changes on comments.

2007-07-11 juga

   * include/filter.php (class FilterMysqlMatch, extract_match_terms):
   - FilterMysqlMatch: renamed boolean-mode -> expert-mode,
     simplified extracting of regex-terms

2007-07-11 rodival

   * include/table_columns.php (make_tablehead),
     include/table_infos.php (make_tablerow),
     skins/dragon/screen.css:
   - enhanced the row highlight display
   - renamed 'remcol.gif' to the more general 'remove.gif'

   * include/std_functions.php:
   - enable the javascript tools.

   * include/translation_functions.php:
   - new try for T_ #info: cut if the char before '#' is not a space

2007-07-10 rodival

   * edit_bio.php:
   - readonly+message instead of disabled

   * game.php:
   - onchange on gotomove select box

   * people.php:
   - "language name not found" now display the language code

   * include/translation_functions.php:
   - better T_ #info cut

2007-07-09 rodival

   * join_waitingroom_game.php, include/make_game.php (create_game(),
     make_standard_placement_of_handicap_stones()):
   - an other try to fix the bad Running count bug:
     a small enhancement of the handicap management.
     a rewrite of join_waitingroom_game.php to make easier the comparison
     with the similar part (create game) of send_message.php.

   * game.php:
   - add of a message to invite the player to validate his action.

2007-07-09 juga

   * game.php:
   - deactivated prev/next game-navigation with images

   * include/message_functions.php:
   - fix last fix for highlighting terms in message: using correct var

2007-07-09 rodival

   * include/std_functions.php, scripts/mailtest.php:
   - adjustments to test a mass email post.

   * forum/forum_functions.php:
   - reverted last fix

2007-07-08 rodival

   * forum/list.php, forum/forum_functions.php,
     include/message_functions.php:
   - emphasized the fact (and fixed some of buggy ones) that a Subject
     must not contain HTML tags. Some fixes around mark_term() are
     temporary and will be better handled soon.

   * forum/search.php:
   - default JOIN changed with INNER JOIN

   * edit_bio.php:
   - limitation of the cells size in an other way than cut_string(),
     not based on the text length but on the box size,
     using disabled or readonly textarea

   * halfhourly_cron.php, send_new_password.php,
     include/std_functions.php:
   - enabled the new send_mail() function everywhere... with a rollback
     possibility because I have no way to test the emails nor on my
     private server either on the devel server. >>> should be tested.

2007-07-08 juga

   * game.php:
   - added images (start/end, previous/next-moves) as links to navigate
     within game; used existing images start/backward/forward/end.gif
     [later removed]

   * users.php, code_examples/query_sql.php, forum/search.php,
     include/message_functions.php:
   - added 'AS' for SQL-table aliases

2007-07-07 rodival

   * show_games.php, users.php, include/message_functions.php,
     include/std_classes.php:
   - default JOIN changed with INNER JOIN

   * include/table_columns.php (make_tablehead),
     skins/dragon/screen.css:
   - added images in the header to show how the table columns are sorted.
     this implied to change the previous hidding red 'x' to an image too.
   - added a constant to disable the second level of sort.

   * images/sort1a.gif, images/sort1d.gif,
     images/sort2a.gif, images/sort2d.gif, images/remove.gif:
   - new images added used for table-sort-indicator
-----------

2007-07-07 rodival

   * include/std_functions.php (send_email, send_message, clean_url,
     is_logged_in):
   - added the send_email() and send_message() functions
   - adjusted clean_url() to chop all the trailing '?' and '&' chars
   - introduced the "fever vault" in is_logged_in(). May be adjusted
     or disabled whith the FEVER_CNT constant. May be tunned for the
     guest account which is a multiple account and so should have larger
     limits.
     The "fever vault" process had 3 main variables: if a user produces
     more that FEVER_CNT page calls during "one hour", he will be
     vaulted for one day (i.e. unable to log himself while receiving
     an info message).
-----------
ALTER TABLE `Players`
 CHANGE `Hits` `Hits` int(11) NOT NULL DEFAULT 0 ,
 ADD `VaultTime` datetime NOT NULL default '0000-00-00 00:00:00' AFTER `Hits` ,
 ADD `VaultCnt` smallint(5) unsigned default 0 NOT NULL AFTER `Hits` ;
-----------

2007-07-07 rodival

   * include/connect2mysql.php (connect2mysql):
   - changed the returned value by connect2mysql(true): in case of
     error, it returns the error message now instead of false.
   - added the mysql_single_col() function

   * error.php,
     include/error_functions.php (set_mode, add_error, error):
   - now set_mode() return the previous mode (to save and restore it)
   - now add_error() and error() return false if the errors are not
     fatal. This allow $result = mysql_query(...) or error(...);
     to continue with $result === false
   - finally, if an error occurs during the initialization of
     error.php, it will no more recall error.php and thus not fall
     in a recursive trap.

2007-07-07 rodival

   * update_translation_pages.php, generate_translation_texts.php,
     message_consistency.php, player_consistency.php, recalculate_ratings2.php,
     start_frozen_clocks.php, convert_posindex.php, convert_from_old_forum.php,
     phpinfo.php:
   - disabled some one shot scripts, enhanced the others

2007-07-06 rodival

   * confirm.php, quick_play.php:
   - moved the place where the GameNotes are deleted
   - few minor debug messages adjustements (quick_play accordingly)

2007-07-06 rodival

   * admin_faq.php:
   - hidden the info box and added an anchor to show it.
   - adjusted some colspan= of the main table.
   - allowed to edit an item even if hidden.
   - inverted the icon of Hide and Show buttons.

2007-07-05 rodival

   * translate.php, update_translation.php,
     include/make_translationfiles.php (translations_query):
   - modified the 'Untranslated' option (may be applied on every group).
     therefore, added a 'All groups' option.
   - hidden the now big info box and added an anchor to show it.

2007-07-03 rodival

   * translate.php, update_translation.php,
     include/make_translationfiles.php (translations_query):
   - added a filter on the english part.
     added the $filter_en argument to translations_query()

   * INSTALL:
   - added a step to protect the scripts/ folder.

2007-07-02 juga

   * show_games.php:
   - added hover-text on colors-column for "my running games"

2007-07-01 juga

   * include/std_functions.php (make_url):
   - reverted changes to make_url-func to fix bug

2007-06-30 juga

   * waiting_room.php:
   - changed bottom-link to 'Show all suitable games' to indicate it's a reset

2007-06-30 juga

   * include/filter.php,
     include/filter_functions.php,
     include/filter_parser.php,
     include/std_classes.php,
     include/tokenizer.php,
   * code_examples/filter_example.php,
     code_examples/filter_example2.php,
     code_examples/query_sql.php,
     code_examples/tokenizer_example.php,
   * skins/dragon/screen.css,
   * specs/filters.txt:
   - added classes and functions comprising new Filter-framework
   - added examples for filter-stuff
   - added some CSS for filters
   - added main-doc in specs/filters.txt

   * include/table_columns.php (Table.constructor, set_externalform,
     set_rows_per_page, use_show_rows, current_filter_string,
     add_or_del_column, handle_show_rows, current_rows_string,
     get_displayed_tableheads, register_filter, get_query,
     add_external_parameters, current_extparams_string):
   - added searching capabilities on table-columns using Filter-framework
     see specs/filters.txt and code_examples/form_example2.php
   - fixed paging-link-bug preserving form-values with links
   - added maxrows-selection to restrict row-size of table-list

   * include/form_functions.php (set_config, get_config,
     set_attr_form_element, set_layout, set_area, add_empty_row,
     create_form_string, get_areaconf),
     code_examples/form_example.php, code_examples/form_example2.php:
   - added Form-types 'FILTER' and 'FILTERERROR' for Filter-framework
   - added area-group layouting and some additional layout-config
     when used as External-Form with Table(-Filters)
   - added example for area-layouting, allow examples to be opened in browser

   * show_games.php, forum/search.php, users.php, waiting_room.php,
     message.php, status.php:
   - added or extended searching capabilities using filter-framework
   - adjustments for using filters
   - added (recommended) new indexes to support new filters;
     needed space + reasons given as comment:
-----------
ALTER TABLE `Games`        -- +3 MB (for filter)
 ADD INDEX `Handicap` (`Handicap`) ;
ALTER TABLE `Games`        -- +2 MB (for filter/sort)
 ADD INDEX `Moves` (`Moves`) ;
ALTER TABLE `Games`        -- +3 MB (for filter/sort)
 ADD INDEX `Score` (`Score`) ;

ALTER TABLE `Posts`        -- +0.2 MB (for filter)
 ADD INDEX `Parent_ID` (`Parent_ID`) ;
ALTER TABLE `Posts`        -- +0.2 MB (for filter/sort)
 ADD INDEX `Time` (`Time`) ;

ALTER TABLE `Players`      -- +0.2 MB (for filter)
 ADD INDEX `Country` (`Country`) ;
ALTER TABLE `Players`      -- +0.4 MB (for filter/sort, often changed)
 ADD INDEX `Lastaccess` (`Lastaccess`) ;
-----------

   * search_messages.php, list_messages.php,
     include/message_functions.php (init_standard_folders, echo_folder_box,
     message_list_query, message_list_table):
   - added new page for searching messages using filters
   - signature-change of funcs to change layout or highlight search-terms:
     message_list_query/_list_table/_info_table, echo_folder_box
   - signature-change of message_list_table-func adding args to control
     message-list output including fields for message-searching:
     folder, type, Direction, message partner
   - added (mandatory) fulltext-index for search on messages
   - slight modifications of SQL using table-alias and join on
     MessageCorrespondents
-----------
ALTER TABLE `Messages`      -- +4 MB (for joins/filter)
 ADD INDEX `ReplyTo` (`ReplyTo`) ;
ALTER TABLE `Messages`     -- ca. +80% of data-size (biggest change)
 ADD FULLTEXT INDEX `Subject` (`Subject`,`Text`) ;
-----------

   * users.php:
   - replaced URL-var 'showall' and page-bottom-link with 'Active'-Table-Filter

   * user_stats.php, userinfo.php, users.php:
   - added new page to show opponents and games-statistics for two players

   * waiting_room.php:
   - added Player-Country-column and Filter on it
   - bugfix: used wrong SQL-field for table-column #1 (sort by name)
   - replaced URL-var 'showall' and page-bottom-link with two Table-Filters
     Suitable-Handicap and Suitable-Rating-Range
   - change page-title reflecting current "suitable"-state
   - re-added page-bottom-links "Show all games" and "Show only suitable
     games" to reset to filter-defaults

   * forum/read.php, forum/search.php,
     forum/forum_functions.php (make_link_array, forum_start_table),
     include/quick_common.php:
   - added order-selectbox in forum-search
   - added support to highlight search-terms in a post or message
   - fixed bug for paging to preserve form- and filter-values
   - fixed bug with relevance when using search-terms in boolean-mode
   - added const DAYS_NEW_END used for forum-reads

   * include/std_functions.php (DEBUG_SQL, map_to_string, mark_terms,
     get_maxrows, build_maxrows_array, make_url, clean_url, has_observers,
     blend_alpha_hex):
   - added some functions and consts to support Filter-framework:
     - support to handle maxrows of table-listing, added funcs
       get_maxrows, build_maxrows_array
     - added allowed HTML-text <term> to support term-highlighting
     - added mark_terms-func to highlight terms within potential XML-text
     - added defaults for Table-Filter-layout
     - adjusted body-width to 90% fixing some strange centric-related layout-
       effects with nested tables (may hopefully get fixed later using CSS)
   - fixed bug in make_url-func only append URI_AMP or '?' if not there,
     added clean_url-func to chop off trailing URI_AMP or '?'
   - changed default-handling of bgcolor for echo_folder_box-func
   - added has_observers-func

   * edit_bio.php:
   - reduce output of bio-texts to 200 chars when changing order

   * site_map.php:
   - added new and search pages

   * game.php:
   - added page-bottom-link to show observers (users.php?observe=<gid>)

   * NEWS, TODO:
   - cleanup some items done

   * INSTALL:
   - move also dot-files like .cvsignore after CVS-checkout

   * scripts/README.developers:
   - added categories and more hints about (surprising) PHP-behaviour
   - don't use filenames with upper-case

2007-06-30 rodival

   * include/std_functions.php, list.php:
   - removed the unused $MaxRowsPerPage global var.

   * include/make_translationfiles.php (translations_query),
   * translate.php, update_translation.php:
   - added a "prev/next" management of the translators' pages.
     added the $from_row argument to translations_query()

   * scripts/README.translations:
   - documenting the "do_it" URL argument of generate_translation_texts.php

2007-06-29 rodival

   * people.php, admin_faq.php:
   - added the info about FAQadmins' activity to "LastUpdate".
-----------
ALTER TABLE `FAQlog`
 ADD `Date` timestamp(14) NOT NULL AFTER `Answer` ;
UPDATE `FAQlog` SET `Date` = '0' ;
-----------

   * translate.php, include/translation_functions.php (language_exists,
     T_, get_language_descriptions_translated):
   - case insensitive search of the language name in language_exists().
   - added an automatic cut of the #xxx part of the alternate english words
     in T_().
   - added a $keep_english parameter to get_language_descriptions_translated().
   - changed all $langcode names to the now more accurate $browsercode.

   * include/make_translationfiles.php (translations_query),
   * admin_translators.php, admin_do_translators.php,
   * translate.php, update_translation.php,
   * scripts/generate_translation_texts.php:
   - added the add_text_to_translate function.
   - added the insertion of the new language names in the translation process.
   - added an optional alphabetical sort in translations_query().
   - added a better "T_(...)" template detection using eval() in
     generate_translation_texts.php. Also added a "do_it" URL argument.
   - changed all $langcode names to the now more accurate $browsercode.

   * scripts/update_translation_pages.php (find_php_files):
   - updated the $directories array in find_php_files().
   - added a "Fatal error" - waiting for a fix - in case of a $TranslateGroups
     not found in the database. The bug may come from a typo in the PHP code
     or from a missing row in the database. The default "do_it" action fix
     this last case.

2007-06-28 rodival

   * statistics.php, graph.php, ratingpng.php, statisticspng.php:
   - added the statratingspng.php file which display stats on ratings.
     Minor adjustements of other files to handle it.
     Added the function patterncolor() to graph.php.

2007-06-26 rodival

   * add_to_waitingroom.php, join_waitingroom_game.php, waiting_room.php:
   - fixed the "double game" handicap option from the waitingroom.
     In the waitingroom table, renamed the old "Handicap" column to
     "Colors" and added the new "Handicap" one containing the number
     of handicap stones.
-----------
ALTER TABLE `Waitingroom`
 ADD `Handicap` Handicap int(11) NOT NULL default '0' AFTER `Komi` ;
-----------

   * include/message_functions.php (game_info_table), send_message.php,
   * include/make_game.php:
   - adjusted to follow the "double game" handicap fix and its display.
   - and a try to fix the bad Running count bug:
     In the Players table, near 20 of the Running counts were 1 or 2
     points too hight. I've not found why this occured. Maybe a script
     abort between two MySQL updates, I don't know.
     Other counts like Finished, Won or Lost were not corrupted.

2007-06-25 rodival

   * scripts/data_report.php:
   - implementation of a two steps validation:
     first, just the EXPLAIN, then the full result.
   - differenciation of the NULL values.

   * scripts/data_export.php:
   - including the translations tables export
     and hidding some minor variations.

2007-06-24 rodival

   * scripts/game_consistency.php, include/move.php (check_move):
   - enhanced consistency check.  Added some Time and Rating checks.
     Now, check_move() returns '' if no error or the error message
     (instead of returning false on error and true else).

   * people.php:
   - changed the info about translators' activity to "LastUpdate".

2007-06-03 rodival

   * game.php, confirm.php:
   - fixed the bug: can't deleted a game while PASS or SCORE step entered
     before the delete limit.
     added the GamesNotes deletion to the delete feature.

   * include/std_functions.php (user_reference):
   - because of old DGS users having a pure numeric Handle (not starting
     by a letter), the illegal_chars($player_ref) call had been replaced
     by a simple ereg() comparison here.

   * userinfo.php, users.php:
   - changed the Percent calculus to 100*(Won+Jigo/2)/RatedGames instead
     of the previous 100*Won/RatedGames.

2007-03-27 rodival

   * edit_vacation.php:
   - fixed the bug: adding 2.00 days to 0.25 days gave 2.00 days.
     In fact, when OnVacation was < 1, one can't add but just start vacations.

2007-03-17 rodival

   * confirm.php:
   - added a missing parenthesis.

   * admin_faq.php:
   - adjusting a 'NULL'.

2007-03-01 rodival

   * images/flags/ls.gif:
   - replaced by the new Lesotho flag (old one kept in ls_old.gif)
-----------

   * images/forward.gif, images/backward.gif,
   * images/end.gif, images/start.gif,
   * images/plus.gif, images/minus.gif, images/cross.gif:
   - added images
-----------

2007-02-04 rodival

   * init.mysql, include/std_functions.php (make_session_code):
   - new MySQL 4.1 behaviour: the PASSWORD() produce a 41-byte hash value
   - modifying Sessioncode in a same spirit
-----------
ALTER TABLE `Players`
 CHANGE `Password` `Password` VARCHAR( 41 ) NOT NULL default '' ,
 CHANGE `Newpassword` `Newpassword` VARCHAR( 41 ) NOT NULL default '' ,
 CHANGE `Sessioncode` `Sessioncode` VARCHAR( 41 ) NOT NULL default '' ;
-----------

   * init.mysql:
   - full periodic check, previous missing update
-----------
ALTER TABLE `TournamentRound`
 CHANGE `Handicaptype` `HandicapType` int(11) NOT NULL default '0' ;
ALTER TABLE `TranslationGroups`
 CHANGE `Groupname` `Groupname` varchar( 32 ) NOT NULL default '' ;
ALTER TABLE `Translations`
 CHANGE `Text` `Text` blob NOT NULL ;
ALTER TABLE `Adminlog`
 CHANGE `Handle` `Handle` varchar(16) NOT NULL default '' ,
 CHANGE `Message` `Message` text NOT NULL ;
ALTER TABLE `Adminlog`
 ADD `IP` varchar(16) NOT NULL default '' AFTER `Date` ;
ALTER TABLE `FAQ`
 CHANGE `Level` `Level` int(11) NOT NULL default '0' ,
 CHANGE `Question` `Question` int(11) NOT NULL default '0' ,
 CHANGE `Answer` `Answer` int(11) NOT NULL default '0' ;
-----------

   * data_export.php:
   - Create_options management added and CSS adjusted.

2007-02-03 rodival

   * include/graph.php, ratingpng.php, ratinggraph.php:
   - rating graph displayed "by number of games"
     (new X-axis option added to the old "by date of games")
   - complete rebuild of graph.php. Graph class added.
     handling the "bynum" option

   * statisticspng.php, statistics.php:
   - using the new Graph class

   * include/rating.php, include/std_functions.php:
   - small modifications consequently

2007-01-25 rodival

   * include/table_columns.php:
   - enhancements mainly to fix the "button" column min-width
     until CSS min-width is working
   - introduced use of external form (var ExternalForm)
   - added funcs: set_default_sort(), get_arg()

   * include/std_functions.php (split_url, yesno, modf & more),
   * include/message_functions.php:
   - added funcs
   - adaptations for enhanced Table_Info class, "button" columns and
     common to waitingroom and message

   * edit_bio.php,
   * list_messages.php,
   * message.php,
   * show_games.php,
   * skins/dragon/screen.css,
   * status.php,
   * userinfo.php,
   * waiting_room.php:
   - using new Table_Info class properties, for games infos and
     common to waitingroom and message

   * NEWS, news.php, skins/dragon/screen.css:
   - adding NEWS file [initally built by JUG] with user-visible changes

2007-01-21 rodival

   * scripts/README.developers, scripts/CHANGELOG.developers, CHANGELOG:
   - added info files

2007-01-12 rodival

   * include/connect2mysql.php (mysql_addslashes) + most of the other
   * files (used nearly everywhere):
   - generalization of the right MySQL addslashes feature,
     introducing function to properly escape value in SQL-statements

   * do_registration.php:
   - rejection of some account usurpers

   * whole set of forum files/functions using table 'Posts.PosIndex':
   - changed 'Posts.PosIndex' to NOT NULL
-----------
ALTER TABLE `Posts`
 CHANGE `PosIndex` `PosIndex` varchar(80) binary NOT NULL default '' ;
-----------

   - removing NULL fields
     the Posts.crc32 int(11) default NULL, seems to be
     kept (while not yet used)
-----------
ALTER TABLE `Players`
 CHANGE `IP` `IP` varchar(16) NOT NULL default '' ;

ALTER TABLE `Posts`
 CHANGE `Time` `Time` datetime NOT NULL default '0000-00-00 00:00:00' ,
 CHANGE `Lastchanged` `Lastchanged` datetime NOT NULL default '0000-00-00 00:00:00' ,
 CHANGE `Lastedited` `Lastedited` datetime NOT NULL default '0000-00-00 00:00:00' ,
 CHANGE `LastPost` `LastPost` int(11) NOT NULL DEFAULT 0 ,
 CHANGE `Subject` `Subject` varchar(80) NOT NULL default '' ,
 CHANGE `Text` `Text` text NOT NULL ,
 CHANGE `User_ID` `User_ID` int(11) NOT NULL DEFAULT 0 ,
 CHANGE `Parent_ID` `Parent_ID` int(11) NOT NULL DEFAULT 0 ,
 CHANGE `PostsInThread` `PostsInThread` int(11) NOT NULL DEFAULT 0 ,
 CHANGE `old_ID` `old_ID` int(11) NOT NULL DEFAULT 0 ;
-----------

   * include/table_infos.php:
   - enhanced Table_Info class to handle waiting_room particularities and
     games info
   - changed syntax of row/column-description (properties)

   * waiting_room.php, userinfo.php, edit_bio.php, status.php:
   - using the new Table_infos class properties

   * skins/dragon/screen.css:
   - to follow the Table_infos modifications

2007-01-10 rodival

   * include/table_infos.php:
   - adding class Table_infos for more CSS friendship

   * userinfo.php, edit_bio.php, status.php:
   - using class Table_infos

2007-01-09 rodival

   * change_bio.php, edit_bio.php: [from code mailing of JUG]
   - adding the "bio infos order" feature
   - removing NULL fields
-----------
ALTER TABLE `Bio`
 ADD `SortOrder` INT( 11 ) DEFAULT 0 NOT NULL AFTER `Text` ;

ALTER TABLE `Bio`
 CHANGE `Category` `Category` VARCHAR( 40 ) NOT NULL DEFAULT '' ,
 CHANGE `Text` `Text` TEXT NOT NULL DEFAULT '' ;
-----------

2006-12-29 rodival

   * include/std_functions.php (verify_email) + all callers:
   - adjusted error signature and error behaviour

2006-12-28 rodival

   * init.mysql:
   - removing NULL fields in database
   - added 'RESULT' to enum Messages.Type for a futur message chain walking
     throught the game comments. The 'RESULT' messages are those send at
     the end of a game.
-----------
ALTER TABLE `Messages`
 CHANGE `Type` `Type` ENUM( 'NORMAL', 'INVITATION', 'ACCEPTED', 'DECLINED', 'DELETED', 'DISPUTED', 'RESULT' ) DEFAULT 'NORMAL' NOT NULL ,
 CHANGE `ReplyTo` `ReplyTo` INT( 11 ) DEFAULT 0 NOT NULL ,
 CHANGE `Game_ID` `Game_ID` INT( 11 ) DEFAULT 0 NOT NULL ,
 CHANGE `Time` `Time` DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL ,
 CHANGE `Subject` `Subject` VARCHAR( 80 ) DEFAULT '' NOT NULL ,
 CHANGE `Text` `Text` TEXT NOT NULL ;

ALTER TABLE `MessageCorrespondents`
 CHANGE `uid` `uid` INT( 11 ) DEFAULT 0 NOT NULL ,
 CHANGE `mid` `mid` INT( 11 ) DEFAULT 0 NOT NULL ;
-----------

   * include/time_functions.php (echo_time_remaining) + all callers:
   - fix bad display of JAP byoyomi when byoyomi reached
     ( "--- + 3 periods of 4h" instead of "4h + 3 periods of 1d" )

   * include/std_functions.php (mysql_single_fetch) + all callers:
   - force to use $debugmsg with mysql_single_fetch()

2006-12-27 rodival

   * images/flags/__.gif:
   - resizing
-----------

   * images/flags/eu.gif:
   - added, though not enabled in countries.php
-----------

2006-12-23 rodival

   * init.mysql:
   - added skinname
-----------
ALTER TABLE `Players`
 ADD `SkinName` VARCHAR( 32 ) DEFAULT '' NOT NULL AFTER `OnVacation` ;
-----------

   * skins/,
   * skins/index.php,
   * skins/known_skins.php,
   * skins/dragon/index.php,
   * skins/dragon/screen.css,
   * skins/dragon/print.css:
   - added CSS files for skins

   * include/std_functions.php (start_page) + all callers:
   - use of skins

   * sgf.php:
   - score 0 for Jigo

-----------
